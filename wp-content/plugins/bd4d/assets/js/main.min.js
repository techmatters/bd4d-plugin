window.bd4d={gcaptchaHandler:function(){grecaptcha.execute(localize.sitekey,{action:"validate_captcha"}).then(function(e){document.getElementById("g-recaptcha-response").value=e})},processSubscription:function(a){a.preventDefault();let e=a.target.querySelector('input[name="email"]').value.trim();var t={_ajax_nonce:localize._ajax_nonce,action:"send_message",token:document.getElementById("g-recaptcha-response").value,email:e},r=a.target.querySelector('input[name="first_name"]'),d=a.target.querySelector('input[name="last_name"]'),n=a.target.querySelector('input[name="affiliation"]'),i=a.target.querySelector('select[name="source"]'),o=a.target.querySelector('textarea[name="message"]'),l=a.target.querySelector('input[name="newsletter"]'),c=a.target.querySelector('input[name="supporter"]');r&&(t.first_name=r.value),d&&(t.last_name=d.value),n&&(t.affiliation=n.value),i&&(t.source=[...i.selectedOptions].map(e=>e.value)),o&&(t.message=o.value),l.checked&&(t.newsletter=l.value),c.checked&&(t.supporter=c.value),jQuery.ajax({type:"POST",url:localize._ajax_url,data:t,success:t=>{if(!0===t.success)jQuery(a.target.querySelector(".form-fields")).slideUp(),document.querySelectorAll("#joinbd4dnet .et_pb_text_inner,#joinbd4dnet .form-fields").forEach(e=>e.classList.remove("hidden")),a.target.querySelector(".message").classList.remove("hidden"),e?a.target.querySelectorAll(".message .yes-email").forEach(e=>e.classList.remove("hidden")):a.target.querySelectorAll(".message .no-email").forEach(e=>e.classList.remove("hidden"));else{let e=localize.error_codes[t?.data?.error_code];4===t?.data?.error_code&&(e+=` (${t?.data?.error_message})`),a.target.querySelector(".error-message").textContent=e,window.bd4d.gcaptchaHandler()}}})},emailFieldHandler:function(e){e.target.value?(window.bd4d.emailCheckbox.removeAttribute("disabled"),window.bd4d.supporterCheckbox.removeAttribute("disabled")):(window.bd4d.emailCheckbox.removeAttribute("checked"),window.bd4d.emailCheckbox.setAttribute("disabled","disabled"),window.bd4d.supporterCheckbox.removeAttribute("checked"),window.bd4d.supporterCheckbox.setAttribute("disabled","disabled"))},setup:function(){var e=document.getElementById("inline-subscribe");e&&(window.bd4d.emailField=document.getElementById("inline-subscribe-email"),window.bd4d.emailCheckbox=document.getElementById("inline-subscribe-newsletter"),window.bd4d.supporterCheckbox=document.getElementById("inline-subscribe-supporter"),window.bd4d.emailField.addEventListener("input",window.bd4d.emailFieldHandler),e.addEventListener("submit",window.bd4d.processSubscription),window.grecaptcha)&&grecaptcha.ready(window.bd4d.gcaptchaHandler)}},document.addEventListener("DOMContentLoaded",window.bd4d.setup);