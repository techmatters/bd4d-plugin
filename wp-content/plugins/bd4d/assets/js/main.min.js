window.bd4d={gcaptchaHandler:function(){grecaptcha.execute(localize.sitekey,{action:"validate_captcha"}).then(function(e){document.getElementById("g-recaptcha-response").value=e})},processSubscription:function(r){let a=document.querySelector('input[type="submit"]'),d=a.value;a.value="Sending...",a.classList.add("is-loading"),a.setAttribute("disabled","disabled"),r.preventDefault();var e={_ajax_nonce:localize._ajax_nonce,action:"send_message",token:document.getElementById("g-recaptcha-response").value},t=r.target.querySelector('input[name="first_name"]').value.trim(),i=r.target.querySelector('input[name="last_name"]').value.trim();let s=r.target.querySelector('input[name="email"]').value.trim();var o=r.target.querySelector('input[name="affiliation"]').value.trim(),n=r.target.querySelector('textarea[name="message"]').value.trim(),l=r.target.querySelector('input[name="newsletter"]'),c=r.target.querySelector('input[name="supporter"]'),u=r.target.querySelector('input[name="adoption"]');s&&(e.email=s),t&&(e.first_name=t),i&&(e.last_name=i),o&&(e.affiliation=o),n&&(e.message=n),l.checked&&(e.newsletter=l.value),c.checked&&(e.supporter=c.value),u.checked&&(e.adoption=u.value),(c.checked||l.checked)&!s?(r.target.querySelectorAll("#inline-subscribe-email").forEach(e=>e.classList.add("has-error")),r.target.querySelector(".error-message").textContent=localize.error_codes[10],window.bd4d.resetButton(a,d)):s||n?jQuery.ajax({type:"POST",url:localize._ajax_url,data:e,success:t=>{if(!0===t.success)r.target.querySelector(".error-message").textContent="",jQuery(r.target.querySelector(".form-fields")).slideUp(),document.querySelectorAll("#joinbd4dnet .et_pb_text_inner,#joinbd4dnet .form-fields").forEach(e=>e.classList.add("hidden")),r.target.querySelector(".message").classList.remove("hidden"),s?r.target.querySelectorAll(".message .yes-email").forEach(e=>e.classList.remove("hidden")):r.target.querySelectorAll(".message .no-email").forEach(e=>e.classList.remove("hidden"));else{let e=localize.error_codes[t?.data?.error_code];4===t?.data?.error_code&&(e+=` (${t?.data?.error_message})`),window.bd4d.showError(a,d,r.target,e)}}}):(r.target.querySelectorAll("#inline-subscribe-email,#inline-subscribe-message").forEach(e=>e.classList.add("has-error")),r.target.querySelector(".error-message").textContent=localize.error_codes[6],window.bd4d.resetButton(a,d))},emailFieldHandler:function(e){e.target.value.trim()?(window.bd4d.emailCheckbox.removeAttribute("disabled"),window.bd4d.supporterCheckbox.removeAttribute("disabled"),window.bd4d.emailField.classList.remove("has-error")):(window.bd4d.emailCheckbox.removeAttribute("checked"),window.bd4d.emailCheckbox.setAttribute("disabled","disabled"),window.bd4d.supporterCheckbox.removeAttribute("checked"),window.bd4d.supporterCheckbox.setAttribute("disabled","disabled"))},messageFieldHandler:function(e){e.target.value.trim()&&window.bd4d.messageField.classList.remove("has-error")},resetButton:function(e,t){e.value=t,e.classList.remove("is-loading"),e.removeAttribute("disabled")},showError:function(e,t,r,a){r=r.querySelector(".error-message");e.value="Failed!",e.classList.remove("is-loading"),e.classList.add("is-error"),r.textContent=a,r.classList.add("is-visible"),window.bd4d.gcaptchaHandler(),setTimeout(function(){e.value=t,e.classList.remove("is-error"),e.removeAttribute("disabled")},2e3)},setup:function(){var e=document.getElementById("inline-subscribe");e&&(window.bd4d.emailField=document.getElementById("inline-subscribe-email"),window.bd4d.messageField=document.getElementById("inline-subscribe-message"),window.bd4d.emailCheckbox=document.getElementById("inline-subscribe-newsletter"),window.bd4d.supporterCheckbox=document.getElementById("inline-subscribe-supporter"),window.bd4d.emailField.addEventListener("input",window.bd4d.emailFieldHandler),window.bd4d.messageField.addEventListener("input",window.bd4d.messageFieldHandler),e.addEventListener("submit",window.bd4d.processSubscription),window.grecaptcha)&&grecaptcha.ready(window.bd4d.gcaptchaHandler)}},document.addEventListener("DOMContentLoaded",window.bd4d.setup);